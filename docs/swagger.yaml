basePath: /
definitions:
  domain.Booking:
    properties:
      booking_date:
        type: string
      created_at:
        type: string
      end_time:
        type: string
      guests_count:
        type: integer
      id:
        type: string
      restaurant:
        $ref: '#/definitions/domain.Restaurant'
      restaurant_id:
        type: string
      special_note:
        type: string
      start_time:
        type: string
      status:
        $ref: '#/definitions/domain.BookingStatus'
      table:
        $ref: '#/definitions/domain.Table'
      table_id:
        type: string
      updated_at:
        type: string
      user:
        $ref: '#/definitions/domain.User'
      user_id:
        type: string
    type: object
  domain.BookingStatus:
    enum:
    - pending
    - confirmed
    - cancelled
    - completed
    - no_show
    type: string
    x-enum-varnames:
    - BookingStatusPending
    - BookingStatusConfirmed
    - BookingStatusCancelled
    - BookingStatusCompleted
    - BookingStatusNoShow
  domain.CuisineType:
    enum:
    - Italian
    - Chinese
    - Mexican
    - Japanese
    - Indian
    - French
    - Kazakh
    - Turkish
    - Thai
    - American
    - Korean
    - Cafe
    - Bar
    - Fast Food
    - Vegetarian
    - Other
    type: string
    x-enum-varnames:
    - CuisineTypeItalian
    - CuisineTypeChinese
    - CuisineTypeMexican
    - CuisineTypeJapanese
    - CuisineTypeIndian
    - CuisineTypeFrench
    - CuisineTypeKazakh
    - CuisineTypeTurkish
    - CuisineTypeThai
    - CuisineTypeAmerican
    - CuisineTypeKorean
    - CuisineTypeCafe
    - CuisineTypeBar
    - CuisineTypeFastFood
    - CuisineTypeVegetarian
    - CuisineTypeOther
  domain.DaySchedule:
    properties:
      close_time:
        type: string
      is_closed:
        type: boolean
      open_time:
        type: string
    type: object
  domain.LocationType:
    enum:
    - window
    - vip
    - regular
    - outdoor
    type: string
    x-enum-varnames:
    - LocationWindow
    - LocationVIP
    - LocationRegular
    - LocationOutdoor
  domain.Payment:
    properties:
      amount:
        type: integer
      booking:
        $ref: '#/definitions/domain.Booking'
      booking_id:
        type: string
      created_at:
        type: string
      error_message:
        type: string
      external_payment_id:
        type: string
      external_payment_url:
        type: string
      id:
        type: string
      payment_method:
        $ref: '#/definitions/domain.PaymentMethod'
      payment_status:
        $ref: '#/definitions/domain.PaymentStatus'
      updated_at:
        type: string
      user:
        $ref: '#/definitions/domain.User'
      user_id:
        type: string
    type: object
  domain.PaymentMethod:
    enum:
    - wallet
    - halyk
    - kaspi
    type: string
    x-enum-varnames:
    - PaymentMethodWallet
    - PaymentMethodHalyk
    - PaymentMethodKaspi
  domain.PaymentStatus:
    enum:
    - pending
    - completed
    - failed
    - refunded
    type: string
    x-enum-varnames:
    - PaymentStatusPending
    - PaymentStatusCompleted
    - PaymentStatusFailed
    - PaymentStatusRefunded
  domain.Restaurant:
    properties:
      address:
        type: string
      average_price:
        type: integer
      bookings:
        items:
          $ref: '#/definitions/domain.Booking'
        type: array
      created_at:
        type: string
      cuisine_type:
        $ref: '#/definitions/domain.CuisineType'
      description:
        type: string
      id:
        type: string
      images:
        items:
          $ref: '#/definitions/domain.RestaurantImage'
        type: array
      instagram:
        type: string
      is_active:
        type: boolean
      latitude:
        type: number
      longitude:
        type: number
      managers:
        items:
          $ref: '#/definitions/domain.RestaurantManager'
        type: array
      max_combinable_tables:
        type: integer
      name:
        type: string
      owner:
        $ref: '#/definitions/domain.User'
      owner_id:
        type: string
      phone:
        type: string
      rating:
        type: number
      reviews:
        items:
          $ref: '#/definitions/domain.Review'
        type: array
      reviews_count:
        type: integer
      tables:
        items:
          $ref: '#/definitions/domain.Table'
        type: array
      updated_at:
        type: string
      website:
        type: string
      working_hours:
        $ref: '#/definitions/domain.WorkingHours'
    type: object
  domain.RestaurantImage:
    properties:
      cloudinary_public_id:
        type: string
      cloudinary_url:
        type: string
      created_at:
        type: string
      id:
        type: string
      is_main:
        type: boolean
      restaurant_id:
        type: string
    type: object
  domain.RestaurantManager:
    properties:
      assigned_at:
        type: string
      id:
        type: string
      restaurant:
        $ref: '#/definitions/domain.Restaurant'
      restaurant_id:
        type: string
      user:
        $ref: '#/definitions/domain.User'
      user_id:
        type: string
    type: object
  domain.Review:
    properties:
      booking:
        $ref: '#/definitions/domain.Booking'
      booking_id:
        type: string
      comment:
        type: string
      created_at:
        type: string
      id:
        type: string
      is_visible:
        type: boolean
      rating:
        type: integer
      restaurant:
        $ref: '#/definitions/domain.Restaurant'
      restaurant_id:
        type: string
      updated_at:
        type: string
      user:
        $ref: '#/definitions/domain.User'
      user_id:
        type: string
    type: object
  domain.Table:
    properties:
      bookings:
        items:
          $ref: '#/definitions/domain.Booking'
        type: array
      created_at:
        type: string
      id:
        type: string
      is_active:
        type: boolean
      location_type:
        $ref: '#/definitions/domain.LocationType'
      max_capacity:
        type: integer
      min_capacity:
        type: integer
      restaurant:
        $ref: '#/definitions/domain.Restaurant'
      restaurant_id:
        type: string
      table_number:
        type: string
      updated_at:
        type: string
      x_position:
        type: integer
      y_position:
        type: integer
    type: object
  domain.TransactionType:
    enum:
    - deposit
    - withdraw
    - booking_charge
    - refund
    - payment_to_restaurant
    type: string
    x-enum-varnames:
    - TransactionDeposit
    - TransactionWithdraw
    - TransactionBookingCharge
    - TransactionRefund
    - TransactionPaymentToRestaurant
  domain.User:
    properties:
      avatar:
        type: string
      bookings:
        items:
          $ref: '#/definitions/domain.Booking'
        type: array
      created_at:
        type: string
      email:
        type: string
      first_name:
        type: string
      id:
        type: string
      is_active:
        type: boolean
      last_login_at:
        type: string
      last_name:
        type: string
      managed_restaurants:
        items:
          $ref: '#/definitions/domain.RestaurantManager'
        type: array
      owned_restaurants:
        items:
          $ref: '#/definitions/domain.Restaurant'
        type: array
      phone:
        type: string
      reviews:
        items:
          $ref: '#/definitions/domain.Review'
        type: array
      role:
        $ref: '#/definitions/domain.UserRole'
      updated_at:
        type: string
    type: object
  domain.UserRole:
    enum:
    - customer
    - owner
    - manager
    - admin
    type: string
    x-enum-varnames:
    - UserRoleCustomer
    - UserRoleOwner
    - UserRoleManager
    - UserRoleAdmin
  domain.Wallet:
    properties:
      balance:
        type: integer
      created_at:
        type: string
      id:
        type: string
      transactions:
        items:
          $ref: '#/definitions/domain.WalletTransaction'
        type: array
      updated_at:
        type: string
      user:
        $ref: '#/definitions/domain.User'
      user_id:
        type: string
    type: object
  domain.WalletTransaction:
    properties:
      amount:
        type: integer
      booking:
        $ref: '#/definitions/domain.Booking'
      booking_id:
        type: string
      created_at:
        type: string
      description:
        type: string
      id:
        type: string
      type:
        $ref: '#/definitions/domain.TransactionType'
      wallet:
        $ref: '#/definitions/domain.Wallet'
      wallet_id:
        type: string
    type: object
  domain.WorkingHours:
    additionalProperties:
      $ref: '#/definitions/domain.DaySchedule'
    type: object
  handler.BookingStatsResponse:
    properties:
      restaurant_id:
        type: string
      stats:
        additionalProperties:
          type: integer
        type: object
    type: object
  handler.BulkNotificationRequest:
    properties:
      message:
        type: string
      recipients:
        items:
          type: string
        type: array
      subject:
        type: string
    required:
    - message
    - recipients
    - subject
    type: object
  handler.CheckAvailabilityRequest:
    properties:
      end_time:
        type: string
      start_time:
        type: string
      table_ids:
        items:
          type: string
        type: array
    required:
    - end_time
    - start_time
    - table_ids
    type: object
  handler.ConcurrentAvailabilityResponse:
    properties:
      availability:
        additionalProperties:
          type: boolean
        type: object
    type: object
  handler.CreatePaymentRequest:
    properties:
      amount:
        minimum: 1
        type: integer
      booking_id:
        type: string
      user_id:
        type: string
    required:
    - amount
    - user_id
    type: object
  handler.DepositRequest:
    properties:
      amount:
        minimum: 1
        type: integer
      description:
        type: string
      user_id:
        type: string
    required:
    - amount
    - user_id
    type: object
  handler.ErrorResponse:
    properties:
      error:
        example: invalid request
        type: string
    type: object
  handler.NotificationStatsResponse:
    properties:
      failed:
        type: integer
      sent:
        type: integer
    type: object
  handler.PaymentWithURLResponse:
    properties:
      external_payment_url:
        type: string
      payment:
        $ref: '#/definitions/domain.Payment'
    type: object
  handler.SearchTablesRequest:
    properties:
      end_time:
        type: string
      guest_count:
        type: integer
      restaurant_ids:
        items:
          type: string
        type: array
      start_time:
        type: string
    required:
    - end_time
    - guest_count
    - restaurant_ids
    - start_time
    type: object
  handler.SearchTablesResponse:
    properties:
      results:
        additionalProperties:
          items:
            type: string
          type: array
        type: object
    type: object
  handler.SuccessResponse:
    properties:
      message:
        example: operation successful
        type: string
    type: object
  handler.WebhookRequest:
    properties:
      external_payment_id:
        type: string
      status:
        type: string
    required:
    - external_payment_id
    - status
    type: object
  handler.WithdrawRequest:
    properties:
      amount:
        minimum: 1
        type: integer
      description:
        type: string
      user_id:
        type: string
    required:
    - amount
    - user_id
    type: object
host: localhost:8080
info:
  contact: {}
  description: API для системы бронирования столиков в ресторанах
  title: Restaurant Booking API
  version: "1.0"
paths:
  /api/demo/booking-stats/{restaurant_id}:
    get:
      description: Get booking statistics for a restaurant (calculated in parallel)
      parameters:
      - description: Restaurant ID
        in: path
        name: restaurant_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handler.BookingStatsResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      summary: Get booking statistics
      tags:
      - Demo - Concurrent Features
  /api/demo/bulk-notifications:
    post:
      consumes:
      - application/json
      description: Send notifications to multiple recipients concurrently
      parameters:
      - description: Bulk notification request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/handler.BulkNotificationRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handler.SuccessResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      summary: Send bulk notifications
      tags:
      - Demo - Concurrent Features
  /api/demo/check-availability:
    post:
      consumes:
      - application/json
      description: Check availability of multiple tables concurrently
      parameters:
      - description: Check availability request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/handler.CheckAvailabilityRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handler.ConcurrentAvailabilityResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      summary: Check multiple tables availability
      tags:
      - Demo - Concurrent Features
  /api/demo/notification-stats:
    get:
      description: Get statistics of sent and failed notifications
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handler.NotificationStatsResponse'
      summary: Get notification statistics
      tags:
      - Demo - Concurrent Features
  /api/demo/search-tables:
    post:
      consumes:
      - application/json
      description: Search for available tables across multiple restaurants in parallel
      parameters:
      - description: Search tables request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/handler.SearchTablesRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handler.SearchTablesResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      summary: Search available tables across restaurants
      tags:
      - Demo - Concurrent Features
  /api/payments:
    get:
      description: Get payment history for a user
      parameters:
      - description: User ID
        in: query
        name: user_id
        required: true
        type: string
      - default: 10
        description: Limit
        in: query
        name: limit
        type: integer
      - default: 0
        description: Offset
        in: query
        name: offset
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/domain.Payment'
            type: array
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      summary: Get user payments
      tags:
      - Payments
  /api/payments/{id}/refund:
    post:
      description: Refund a completed payment
      parameters:
      - description: Payment ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handler.SuccessResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      summary: Refund payment
      tags:
      - Payments
  /api/payments/halyk:
    post:
      consumes:
      - application/json
      description: Create payment via Halyk Bank (returns payment URL)
      parameters:
      - description: Payment request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/handler.CreatePaymentRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handler.PaymentWithURLResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      summary: Create Halyk Bank payment
      tags:
      - Payments
  /api/payments/kaspi:
    post:
      consumes:
      - application/json
      description: Create payment via Kaspi (returns payment URL)
      parameters:
      - description: Payment request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/handler.CreatePaymentRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handler.PaymentWithURLResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      summary: Create Kaspi payment
      tags:
      - Payments
  /api/payments/wallet:
    post:
      consumes:
      - application/json
      description: Create payment using wallet balance
      parameters:
      - description: Payment request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/handler.CreatePaymentRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/domain.Payment'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      summary: Create wallet payment
      tags:
      - Payments
  /api/payments/webhook/halyk:
    post:
      consumes:
      - application/json
      description: Webhook endpoint for Halyk Bank payment notifications
      parameters:
      - description: Webhook request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/handler.WebhookRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handler.SuccessResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      summary: Halyk Bank webhook
      tags:
      - Payments
  /api/payments/webhook/kaspi:
    post:
      consumes:
      - application/json
      description: Webhook endpoint for Kaspi payment notifications
      parameters:
      - description: Webhook request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/handler.WebhookRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handler.SuccessResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      summary: Kaspi webhook
      tags:
      - Payments
  /api/wallet:
    get:
      description: Get or create wallet for a user
      parameters:
      - description: User ID
        in: query
        name: user_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/domain.Wallet'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      summary: Get user wallet
      tags:
      - Wallet
  /api/wallet/deposit:
    post:
      consumes:
      - application/json
      description: Add funds to user's wallet
      parameters:
      - description: Deposit request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/handler.DepositRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/domain.Wallet'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      summary: Deposit to wallet
      tags:
      - Wallet
  /api/wallet/transactions:
    get:
      description: Get transaction history for a user's wallet
      parameters:
      - description: User ID
        in: query
        name: user_id
        required: true
        type: string
      - default: 10
        description: Limit
        in: query
        name: limit
        type: integer
      - default: 0
        description: Offset
        in: query
        name: offset
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/domain.WalletTransaction'
            type: array
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      summary: Get wallet transactions
      tags:
      - Wallet
  /api/wallet/withdraw:
    post:
      consumes:
      - application/json
      description: Withdraw funds from user's wallet
      parameters:
      - description: Withdraw request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/handler.WithdrawRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/domain.Wallet'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      summary: Withdraw from wallet
      tags:
      - Wallet
schemes:
- http
swagger: "2.0"
